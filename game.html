<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cattura i Regali di Natale (Livelli Auto)</title>
    <style>
        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            font-family: Arial, sans-serif;
            background-color: #f0f8ff;
        }
        #game-container {
            width: 500px;
            height: 400px;
            border: 5px solid #0056b3;
            background-color: #e0ffff;
            position: relative;
            overflow: hidden;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        }
        .falling-object {
            position: absolute;
            font-size: 45px;
            text-align: center;
            user-select: none;
        }
        #sleigh {
            position: absolute;
            bottom: 0;
            width: 80px; 
            height: 50px;
            text-align: center;
            font-size: 55px; 
            cursor: move;
            user-select: none;
        }
        /* AGGIORNATO: Ora usa flexbox per allineare punteggio e pulsante */
        #score-panel { 
            margin-top: 10px;
            padding: 10px;
            background-color: #fff;
            border: 2px solid #0056b3;
            width: 500px;
            text-align: center;
            
            display: flex; 
            justify-content: space-around;
            align-items: center;
        }
        #level-display {
            font-weight: bold;
            color: #d9534f;
        }
    </style>
</head>
<body>

    <h2>üéÑ Cattura i Regali in Caduta üéÖ</h2>
    <p>Usa il mouse per trascinare Babbo Natale o le frecce della tastiera (‚Üê e ‚Üí).</p>

    <div id="score-panel">
        <div>Livello: <span id="level-display">1</span></div>
        <div>Punteggio: <span id="score">0</span></div>
        <div>Mancati: <span id="missed">0</span></div>
        <button id="restart-button">Riavvia il Gioco</button>
    </div>

    <div id="game-container">
        <div id="sleigh">üéÖ</div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // =========================================================
            // üîë VARIABILI DIDATTICHE E MODIFICABILI
            // =========================================================

            let GRAVITY_FACTOR = 1.2; // üö© INIZIO con gravit√† 1.2
            let SPAWN_INTERVAL_MS = 1000; 
            const SLEIGH_WIDTH = 80;    
            const OBJECT_SIZE = 45;     
            const SLEIGH_SPEED = 10; 
            const COLLISION_BUFFER_Y = 20; 

            // VARIABILI PER IL SISTEMA A LIVELLI
            let currentLevel = 1;
            const INITIAL_GRAVITY = 1.2; // üö© Definizione del punto di partenza
            const SCORE_TO_NEXT_LEVEL = 150; 
            const LEVEL_INCREASE_GRAVITY = 0.2; 
            const LEVEL_DECREASE_SPAWN = 50; 

            // =========================================================
            // LOGICA DI BASE
            // =========================================================

            const container = document.getElementById('game-container');
            const sleigh = document.getElementById('sleigh');
            const scoreDisplay = document.getElementById('score');
            const missedDisplay = document.getElementById('missed');
            const levelDisplay = document.getElementById('level-display');
            const restartButton = document.getElementById('restart-button'); 

            let score = 0;
            let missed = 0;
            let gameLoopInterval;
            let spawnInterval;
            let running = false;
            
            const objects = [];
            let sleighX;

            function initSleighPosition() {
                sleighX = container.clientWidth / 2 - SLEIGH_WIDTH / 2;
                sleigh.style.left = sleighX + 'px';
            }
            initSleighPosition();

            function updateSleighPosition(newX) {
                if (newX < 0) {
                    newX = 0;
                } else if (newX > container.clientWidth - SLEIGH_WIDTH) {
                    newX = container.clientWidth - SLEIGH_WIDTH;
                }
                sleigh
